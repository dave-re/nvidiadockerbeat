package main

import (
	"log"
	"net/http"
)

const (
	infoJSON   = `{"Version":{"Driver":"378.13","CUDA":"8.0"},"Devices":[{"UUID":"GPU-66a2874a-837d-cd53-ab26-0d2d842d9822","Path":"/dev/nvidia0","Model":"Tesla P40","Power":250,"CPUAffinity":0,"PCI":{"BusID":"0000:08:00.0","BAR1":32768,"Bandwidth":15760},"Clocks":{"Cores":1531,"Memory":3615},"Topology":[{"BusID":"0000:0B:00.0","Link":5},{"BusID":"0000:0E:00.0","Link":5},{"BusID":"0000:11:00.0","Link":5},{"BusID":"0000:16:00.0","Link":3},{"BusID":"0000:19:00.0","Link":3},{"BusID":"0000:1C:00.0","Link":3},{"BusID":"0000:22:00.0","Link":3}],"Family":"Pascal","Arch":"6.1","Cores":3840,"Memory":{"ECC":true,"Global":22912,"Shared":96,"Constant":64,"L2Cache":3072,"Bandwidth":347040}},{"UUID":"GPU-535c289c-6dd8-e308-b4ca-524b0fc07fa6","Path":"/dev/nvidia1","Model":"Tesla P40","Power":250,"CPUAffinity":0,"PCI":{"BusID":"0000:0B:00.0","BAR1":32768,"Bandwidth":15760},"Clocks":{"Cores":1531,"Memory":3615},"Topology":[{"BusID":"0000:08:00.0","Link":5},{"BusID":"0000:0E:00.0","Link":5},{"BusID":"0000:11:00.0","Link":5},{"BusID":"0000:16:00.0","Link":3},{"BusID":"0000:19:00.0","Link":3},{"BusID":"0000:1C:00.0","Link":3},{"BusID":"0000:22:00.0","Link":3}],"Family":"Pascal","Arch":"6.1","Cores":3840,"Memory":{"ECC":true,"Global":22912,"Shared":96,"Constant":64,"L2Cache":3072,"Bandwidth":347040}},{"UUID":"GPU-149648d8-7e32-715a-b5c3-fe6df5976c7e","Path":"/dev/nvidia2","Model":"Tesla P40","Power":250,"CPUAffinity":0,"PCI":{"BusID":"0000:0E:00.0","BAR1":32768,"Bandwidth":15760},"Clocks":{"Cores":1531,"Memory":3615},"Topology":[{"BusID":"0000:08:00.0","Link":5},{"BusID":"0000:0B:00.0","Link":5},{"BusID":"0000:11:00.0","Link":5},{"BusID":"0000:16:00.0","Link":3},{"BusID":"0000:19:00.0","Link":3},{"BusID":"0000:1C:00.0","Link":3},{"BusID":"0000:22:00.0","Link":3}],"Family":"Pascal","Arch":"6.1","Cores":3840,"Memory":{"ECC":true,"Global":22912,"Shared":96,"Constant":64,"L2Cache":3072,"Bandwidth":347040}},{"UUID":"GPU-723aa4d3-9c36-dc2b-5455-c91110eb7d67","Path":"/dev/nvidia3","Model":"Tesla P40","Power":250,"CPUAffinity":0,"PCI":{"BusID":"0000:11:00.0","BAR1":32768,"Bandwidth":15760},"Clocks":{"Cores":1531,"Memory":3615},"Topology":[{"BusID":"0000:08:00.0","Link":5},{"BusID":"0000:0B:00.0","Link":5},{"BusID":"0000:0E:00.0","Link":5},{"BusID":"0000:16:00.0","Link":3},{"BusID":"0000:19:00.0","Link":3},{"BusID":"0000:1C:00.0","Link":3},{"BusID":"0000:22:00.0","Link":3}],"Family":"Pascal","Arch":"6.1","Cores":3840,"Memory":{"ECC":true,"Global":22912,"Shared":96,"Constant":64,"L2Cache":3072,"Bandwidth":347040}},{"UUID":"GPU-683c7434-0446-d65a-5b82-1055000ef790","Path":"/dev/nvidia4","Model":"Tesla P40","Power":250,"CPUAffinity":0,"PCI":{"BusID":"0000:16:00.0","BAR1":32768,"Bandwidth":15760},"Clocks":{"Cores":1531,"Memory":3615},"Topology":[{"BusID":"0000:08:00.0","Link":3},{"BusID":"0000:0B:00.0","Link":3},{"BusID":"0000:0E:00.0","Link":3},{"BusID":"0000:11:00.0","Link":3},{"BusID":"0000:19:00.0","Link":5},{"BusID":"0000:1C:00.0","Link":5},{"BusID":"0000:22:00.0","Link":5}],"Family":"Pascal","Arch":"6.1","Cores":3840,"Memory":{"ECC":true,"Global":22912,"Shared":96,"Constant":64,"L2Cache":3072,"Bandwidth":347040}},{"UUID":"GPU-efe9a6bc-9036-e314-8ec1-b9b6f87b2077","Path":"/dev/nvidia5","Model":"Tesla P40","Power":250,"CPUAffinity":0,"PCI":{"BusID":"0000:19:00.0","BAR1":32768,"Bandwidth":15760},"Clocks":{"Cores":1531,"Memory":3615},"Topology":[{"BusID":"0000:08:00.0","Link":3},{"BusID":"0000:0B:00.0","Link":3},{"BusID":"0000:0E:00.0","Link":3},{"BusID":"0000:11:00.0","Link":3},{"BusID":"0000:16:00.0","Link":5},{"BusID":"0000:1C:00.0","Link":5},{"BusID":"0000:22:00.0","Link":5}],"Family":"Pascal","Arch":"6.1","Cores":3840,"Memory":{"ECC":true,"Global":22912,"Shared":96,"Constant":64,"L2Cache":3072,"Bandwidth":347040}},{"UUID":"GPU-538ef4bb-f733-be14-d4f6-bc3e067da002","Path":"/dev/nvidia6","Model":"Tesla P40","Power":250,"CPUAffinity":0,"PCI":{"BusID":"0000:1C:00.0","BAR1":32768,"Bandwidth":15760},"Clocks":{"Cores":1531,"Memory":3615},"Topology":[{"BusID":"0000:08:00.0","Link":3},{"BusID":"0000:0B:00.0","Link":3},{"BusID":"0000:0E:00.0","Link":3},{"BusID":"0000:11:00.0","Link":3},{"BusID":"0000:16:00.0","Link":5},{"BusID":"0000:19:00.0","Link":5},{"BusID":"0000:22:00.0","Link":5}],"Family":"Pascal","Arch":"6.1","Cores":3840,"Memory":{"ECC":true,"Global":22912,"Shared":96,"Constant":64,"L2Cache":3072,"Bandwidth":347040}},{"UUID":"GPU-da0b2c3b-ef33-ef07-a3e4-404e8f55d152","Path":"/dev/nvidia7","Model":"Tesla P40","Power":250,"CPUAffinity":0,"PCI":{"BusID":"0000:22:00.0","BAR1":32768,"Bandwidth":15760},"Clocks":{"Cores":1531,"Memory":3615},"Topology":[{"BusID":"0000:08:00.0","Link":3},{"BusID":"0000:0B:00.0","Link":3},{"BusID":"0000:0E:00.0","Link":3},{"BusID":"0000:11:00.0","Link":3},{"BusID":"0000:16:00.0","Link":5},{"BusID":"0000:19:00.0","Link":5},{"BusID":"0000:1C:00.0","Link":5}],"Family":"Pascal","Arch":"6.1","Cores":3840,"Memory":{"ECC":true,"Global":22912,"Shared":96,"Constant":64,"L2Cache":3072,"Bandwidth":347040}}]}`
	statusJSON = `{"Devices":[{"Power":13,"Temperature":15,"Utilization":{"GPU":0,"Memory":0,"Encoder":0,"Decoder":0},"Memory":{"GlobalUsed":8,"ECCErrors":{"L1Cache":null,"L2Cache":null,"Global":null}},"Clocks":{"Cores":40,"Memory":405},"PCI":{"BAR1Used":2,"Throughput":{"RX":0,"TX":0}},"Processes":null},{"Power":9,"Temperature":14,"Utilization":{"GPU":0,"Memory":0,"Encoder":0,"Decoder":0},"Memory":{"GlobalUsed":7,"ECCErrors":{"L1Cache":null,"L2Cache":null,"Global":null}},"Clocks":{"Cores":40,"Memory":405},"PCI":{"BAR1Used":2,"Throughput":{"RX":0,"TX":0}},"Processes":null},{"Power":9,"Temperature":18,"Utilization":{"GPU":0,"Memory":0,"Encoder":0,"Decoder":0},"Memory":{"GlobalUsed":7,"ECCErrors":{"L1Cache":null,"L2Cache":null,"Global":null}},"Clocks":{"Cores":40,"Memory":405},"PCI":{"BAR1Used":2,"Throughput":{"RX":0,"TX":0}},"Processes":null},{"Power":9,"Temperature":16,"Utilization":{"GPU":0,"Memory":0,"Encoder":0,"Decoder":0},"Memory":{"GlobalUsed":7,"ECCErrors":{"L1Cache":null,"L2Cache":null,"Global":null}},"Clocks":{"Cores":40,"Memory":405},"PCI":{"BAR1Used":2,"Throughput":{"RX":0,"TX":0}},"Processes":null},{"Power":9,"Temperature":20,"Utilization":{"GPU":0,"Memory":0,"Encoder":0,"Decoder":0},"Memory":{"GlobalUsed":7,"ECCErrors":{"L1Cache":null,"L2Cache":null,"Global":null}},"Clocks":{"Cores":40,"Memory":405},"PCI":{"BAR1Used":2,"Throughput":{"RX":0,"TX":0}},"Processes":null},{"Power":9,"Temperature":15,"Utilization":{"GPU":0,"Memory":0,"Encoder":0,"Decoder":0},"Memory":{"GlobalUsed":7,"ECCErrors":{"L1Cache":null,"L2Cache":null,"Global":null}},"Clocks":{"Cores":40,"Memory":405},"PCI":{"BAR1Used":2,"Throughput":{"RX":0,"TX":0}},"Processes":null},{"Power":9,"Temperature":18,"Utilization":{"GPU":0,"Memory":0,"Encoder":0,"Decoder":0},"Memory":{"GlobalUsed":7,"ECCErrors":{"L1Cache":null,"L2Cache":null,"Global":null}},"Clocks":{"Cores":40,"Memory":405},"PCI":{"BAR1Used":2,"Throughput":{"RX":0,"TX":0}},"Processes":null},{"Power":9,"Temperature":17,"Utilization":{"GPU":0,"Memory":0,"Encoder":0,"Decoder":0},"Memory":{"GlobalUsed":7,"ECCErrors":{"L1Cache":null,"L2Cache":null,"Global":null}},"Clocks":{"Cores":40,"Memory":405},"PCI":{"BAR1Used":2,"Throughput":{"RX":0,"TX":0}},"Processes":null}]}`
)

func main() {
	http.HandleFunc("/v1.0/gpu/info/json", func(w http.ResponseWriter, r *http.Request) {
		w.Header().Set("Content-Type", "application/json")
		w.Write([]byte(infoJSON))
	})

	http.HandleFunc("/v1.0/gpu/status/json", func(w http.ResponseWriter, r *http.Request) {
		w.Header().Set("Content-Type", "application/json")
		w.Write([]byte(infoJSON))
	})

	log.Fatal(http.ListenAndServe(":3476", nil))
}
